<!DOCTYPE html>
<html>
<head>
  <title>Joystick</title>
  <style>
    body, html {
      padding: 0;
      margin: 0;
    }
    .zone {
      display: block;
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 50%;
      min-width: 100%;
      min-height: 50%;
      background: rgba(255, 0, 0, 0.1);
    }
  </style>
</head>
<body>
  <div id="dynamic" class="zone"></div>

  <script src="file:///android_asset/nipplejs.js"></script>

  <script>
    function printStuff(stuff){
      var el = document.createElement("pre");
      var str = JSON.stringify(stuff);
      el.innerHTML = str;
      document.body.appendChild(el);
    }

    function sendMessage(txt) {
      // printStuff("Sending: " + txt); /* uncomment to DEBUG :) */
      try {
        window.postMessage(txt, '*'); /* Remove the star and it will stop to work on Android */
      } catch(err) {
        printStuff("ERROR!");
        printStuff(err.toString());
      }
    }
  </script>

  <script>
    var manager = nipplejs.create({
      zone: document.getElementById('dynamic'),
      color: 'blue'
    });

    manager.on('move', function (evt, data) {
      sendMessage(JSON.stringify({ type: 'move', data: data}));
      // var searchParams = new URLSearchParams(window.location.search);
      // sendMessage('PARAMS:' + JSON.stringify(searchParams.get('height')))
    });
  </script>
</body>
</html>
